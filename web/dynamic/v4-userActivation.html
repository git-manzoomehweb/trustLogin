<!DOCTYPE html>
<basis core="group" name="lid" if="'[##cms.query.lid|(1)##]' = '1'">
    <html lang="fa">
</basis>
<basis core="group" name="lid" if="'[##cms.query.lid|(1)##]' = '2'">
    <html lang="en">
</basis>
<basis core="group" name="lid" if="'[##cms.query.lid|(1)##]' = '3'">
    <html lang="ar">
</basis>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="[##cms.seo.description##]">
    <basis core="dbsource" source="hosting" name="tag" urlid="[##cms.seo.urlid##]">
        <member type="list" name="list" request="taglist" preview=""></member>
    </basis>
    <basis core="print" datamembername="tag.list">
        <face filter="key='canonical'">
            <link rel="canonical" href="@value" />
        </face>
        <face>
            <meta property="@key" content="@value" />
        </face>
    </basis>
    <basis core="group" name="lid" if="'[##cms.query.lid|(1)##]' = '1'">
        <title>[##cms.seo.title|(تکمیل فرایند ثبت نام)##]</title>
        <link href="[##cms.cms.cdn##]/css/style_tem.css" type="text/css" rel="stylesheet" />
       <link href="[##cms.cms.cdn##]/authentication/css/authentication.temp.min.css?ver=1" type="text/css" rel="stylesheet" />
    </basis>
    <basis core="group" name="lid" if="'[##cms.query.lid|(1)##]' = '2'">
        <title>[##cms.seo.title|(complete registration)##]</title>
        <link href="[##cms.cms.cdn##]/css/style_tem_en.css" type="text/css" rel="stylesheet" />
    </basis>
    <basis core="group" name="lid" if="'[##cms.query.lid|(1)##]' = '3'">
        <title>[##cms.seo.title|(أكمل عملية التسجيل)##]</title>
        <link href="[##cms.cms.cdn##]/css/style_tem_ar.css" type="text/css" rel="stylesheet" />
    </basis>
</head>

<body>
    <main class="main-container">
        <basis core="group" name="lid" if="'[##cms.query.lid|(1)##]' = '1'">
            <basis core="call" file="header.inc" lid="[##cms.query.lid|(1)##]"></basis>
            <div class="clr"></div>
            <section class="content">
                <div class="main-operationUser-container rtl-lang">
                    <form>
                        <h1> تکمیل فرایند ثبت نام </h1>
                        <basis core="api" name="api.useractivation" run="AtClient"
                            url="https://api.trust-login.com/useractivation" method="post"
                            body='{"rkey": "[##cms.query.rkey##]"}' onprocessed="onProcessedUserActivation">
                        </basis>
                        <basis core='callback' run='AtClient' method='checkSource' triggers='api.useractivation'>
                        </basis>
                        <basis core='api' if='{##complete.registration.run|(false)##}' run='AtClient'
                            url='https://api.trust-login.com/schema/{##complete.registration.rkey##}/fa' method='get'
                            triggers='complete.registration'></basis>
                        <basis core="schema" run="AtClient" datamembername="answer.data"
                            if='{##complete.registration.run|(false)##}' schemaurl="https://api.trust-login.com/schema"
                            displaymode="edit" triggers='complete.registration' button="[data-btn-editUser]"
                            resultsourceid="editUser.data"></basis>
                        <basis core="cookie" name="rkey" if="{##complete.registration.run|(false)##}" run="AtClient"
                            value="{##complete.registration.rkey##}" triggers="complete.registration"></basis>
                        <basis core="callback" run="AtClient" method="editUser" triggers="editUser.data"></basis>
                        <basis core="api" name="api.edituser" if="{##page.editUser.run|(false)##}" run="AtClient"
                            url="https://api.trust-login.com/schema/{##complete.registration.rkey##}/editobject"
                            method="post" body='{"data": {##page.editUser.value##}}' onprocessed="onProcessedEditUser"
                            triggers="page.editUser">
                        </basis>
                        <div class="bottom-content">
                            <div class="login-btn-content"><button type="submit" data-btn-editUser=""
                                    onclick="document.querySelector('.main-operationUser-container').querySelector('.action-loading').classList.remove('hidden');"
                                    class="login-btn background-color_1 bg-primary hidden">ثبت
                                </button></div>
                            <div class="action-loading background-color_1 bg-primary hidden">
                                <div id="ballsWaveG">
                                    <div id="ballsWaveG_1" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_2" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_3" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_4" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_5" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_6" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_7" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_8" class="ballsWaveG"></div>
                                </div>
                            </div>

                        </div>
                        <div class="api-message"></div>
                        <div class="clr"></div>
                    </form>
                </div>
                <div class="clr"></div>
            </section>
            <script src="[##cms.cms.cdn##]/_js/jquery/jquery-3.6.3.min.js" type="text/javascript"></script>
            <basis core="call" lid="1" file="footer.inc"></basis>
        </basis>
        <basis core="group" name="lid" if="'[##cms.query.lid|(1)##]' = '2'">
            <basis core="call" file="header-en.inc"></basis>
            <div class="clr"></div>
            <section class="content">
                <div class="main-operationUser-container ltr-lang">
                    <form>
                        <h1> complete registration </h1>
                        <basis core="api" name="api.useractivation" run="AtClient"
                            url="https://api.trust-login.com/useractivation" method="post"
                            body='{"rkey": "[##cms.query.rkey##]"}' onprocessed="onProcessedUserActivation">
                        </basis>
                        <basis core='api' if='{##complete.registration.run|(false)##}' run='AtClient'
                            url='https://api.trust-login.com/schema/{##complete.registration.rkey##}/en' method='get'
                            triggers='complete.registration'></basis>
                        <basis core="schema" run="AtClient" datamembername="answer.data"
                            if='{##complete.registration.run|(false)##}' schemaurl="https://api.trust-login.com/schema"
                            displaymode="edit" triggers='complete.registration' button="[data-btn-editUser]"
                            resultsourceid="editUser.data"></basis>
                        <basis core="cookie" name="rkey" if="{##complete.registration.run|(false)##}" run="AtClient"
                            value="{##complete.registration.rkey##}" triggers="complete.registration"></basis>
                        <basis core="callback" run="AtClient" method="editUser" triggers="editUser.data"></basis>
                        <basis core="api" name="api.edituser" if="{##page.editUser.run|(false)##}" run="AtClient"
                            url="https://api.trust-login.com/schema/{##complete.registration.rkey##}/editobject"
                            method="post" body='{"data": {##page.editUser.value##}}' onprocessed="onProcessedEditUser"
                            triggers="page.editUser">
                        </basis>
                        <div class="bottom-content">
                            <div class="login-btn-content"><button type="submit" data-btn-editUser=""
                                    onclick="document.querySelector('.main-operationUser-container').querySelector('.action-loading').classList.remove('hidden');"
                                    class="login-btn background-color_1 bg-primary hidden">Submit
                                </button></div>
                            <div class="action-loading background-color_1 bg-primary hidden">
                                <div id="ballsWaveG">
                                    <div id="ballsWaveG_1" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_2" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_3" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_4" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_5" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_6" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_7" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_8" class="ballsWaveG"></div>
                                </div>
                            </div>
                        </div>
                        <div class="api-message"></div>
                        <div class="clr"></div>
                    </form>

                </div>
                <div class="clr"></div>
            </section>
            <script src="[##cms.cms.cdn##]/_js/jquery/jquery-3.6.3.min.js" type="text/javascript"></script>
            <basis core="call" file="footer-en.inc"></basis>
        </basis>
        <basis core="group" name="lid" if="'[##cms.query.lid|(1)##]' = '3'">
            <basis core="call" file="header-ar.inc"></basis>
            <div class="clr"></div>
            <section class="content">
                <div class="main-operationUser-container rtl-lang">
                    <form>
                        <h1> أكمل عملية التسجيل </h1>
                        <basis core="api" name="api.useractivation" run="AtClient"
                            url="https://api.trust-login.com/useractivation" method="post"
                            body='{"rkey": "[##cms.query.rkey##]"}' onprocessed="onProcessedUserActivation">
                        </basis>
                        <basis core='api' if='{##complete.registration.run|(false)##}' run='AtClient'
                            url='https://api.trust-login.com/schema/{##complete.registration.rkey##}/ar' method='get'
                            triggers='complete.registration'></basis>
                        <basis core="schema" run="AtClient" datamembername="answer.data"
                            if='{##complete.registration.run|(false)##}' schemaurl="https://api.trust-login.com/schema"
                            displaymode="edit" triggers='complete.registration' button="[data-btn-editUser]"
                            resultsourceid="editUser.data"></basis>
                        <basis core="cookie" name="rkey" if="{##complete.registration.run|(false)##}" run="AtClient"
                            value="{##complete.registration.rkey##}" triggers="complete.registration"></basis>
                        <basis core="callback" run="AtClient" method="editUser" triggers="editUser.data"></basis>
                        <basis core="api" name="api.edituser" if="{##page.editUser.run|(false)##}" run="AtClient"
                            url="https://api.trust-login.com/schema/{##complete.registration.rkey##}/editobject"
                            method="post" body='{"data": {##page.editUser.value##}}' onprocessed="onProcessedEditUser"
                            triggers="page.editUser">
                        </basis>
                        <div class="bottom-content">
                            <div class="login-btn-content"><button type="submit" data-btn-editUser=""
                                    onclick="document.querySelector('.main-operationUser-container').querySelector('.action-loading').classList.remove('hidden');"
                                    class="login-btn background-color_1 bg-primary hidden">تسجيل
                                </button></div>
                            <div class="action-loading background-color_1 bg-primary hidden">
                                <div id="ballsWaveG">
                                    <div id="ballsWaveG_1" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_2" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_3" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_4" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_5" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_6" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_7" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_8" class="ballsWaveG"></div>
                                </div>
                            </div>

                        </div>
                        <div class="api-message"></div>
                        <div class="clr"></div>
                    </form>
                </div>
                <div class="clr"></div>
            </section>
            <script src="[##cms.cms.cdn##]/_js/jquery/jquery-3.6.3.min.js" type="text/javascript"></script>
            <basis core="call" file="footer-ar.inc"></basis>
        </basis>

    </main>

    <script type="text/javascript">
        function checkSource(args) {
            console.log('api.useractivation')
            console.log(args)
        }
        async function onProcessedUserActivation(args) {
            const response = args.response;
            if (response.status == 200) {
                const responseJson = await response.json();
                if (!responseJson.errorMessage) {
                    if (responseJson.errorid == '8') {
                        document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = `
    <div class="error"> ${'[##cms.query.lid|(1)##]' == '1' ? `فعال‌سازی این ایمیل انجام شده است` :
                                '[##cms.query.lid|(1)##]' == '3' ? `تم تفعيل هذا البريد الإلكتروني` :
                                    `This email has been activated`
                            }</div>`;
                    } else if (responseJson.errorid == '10') {
                        document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = `
    <div class="error"> ${'[##cms.query.lid|(1)##]' == '1' ? `ورودی های ارسال شده نامعتبر است` :
                                '[##cms.query.lid|(1)##]' == '3' ? `المدخلات المقدمة غير صالحة` :
                                    `Entries submitted are invalid`
                            }</div>`;

                    } else if (responseJson.errorid == '20') {
                        document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = `
    <div class="error"> ${'[##cms.query.lid|(1)##]' == '1' ? `شناسه کاربر نامعتبر است` :
                                '[##cms.query.lid|(1)##]' == '3' ? `معرف المستخدم غير صالح` :
                                    `The user ID is invalid`
                            }</div>`;
                    } else if (responseJson.errorid == '25') {
                        document.querySelector(".main-operationUser-container").querySelector(".login-btn").classList.remove("hidden");
                        document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = `
    <div class="success"> ${'[##cms.query.lid|(1)##]' == '1' ? `ثبت نام شما با موفقیت انجام شد، لطفا جهت تکمیل فرایند ثبت نام، اطلاعات زیر را وارد نمایید` :
                                '[##cms.query.lid|(1)##]' == '3' ? `تم تسجيلك بنجاح، يرجى إدخال المعلومات أدناه لإكمال عملية التسجيل` :
                                    `Your registration was successful`
                            }</div>`;
                        $bc.setSource("complete.registration", {
                            rkey: responseJson.rkey,
                            run: true
                        });
                    } else if (responseJson.errorid == '26') {
                        document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = `
    <div class="error"> ${'[##cms.query.lid|(1)##]' == '1' ? `فعال سازی نام کاربری شما انجام شده است` :
                                '[##cms.query.lid|(1)##]' == '3' ? `تم تفعيل اسم المستخدم الخاص بك` :
                                    `Your username has been activated`
                            }</div>`;
                    } else if (responseJson.errorid == '56') {
                        document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = `
    <div class="error"> ${'[##cms.query.lid|(1)##]' == '1' ? `فعالسازی این ایمیل انجام شده است` :
                                '[##cms.query.lid|(1)##]' == '3' ? `تم تفعيل هذا البريد الإلكتروني` :
                                    `This email has been activated`
                            }</div>`;

                    } else if (responseJson.errorid == '57') {
                        document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = `
    <div class="error"> ${'[##cms.query.lid|(1)##]' == '1' ? `فعالسازی این کاربر انجام شده است` :
                                '[##cms.query.lid|(1)##]' == '3' ? `تم تفعيل هذا المستخدم` :
                                    `This user has been activated`
                            }</div>`;

                    } else if (responseJson.errorid == '59') {
                        document.querySelector(".main-operationUser-container").querySelector(".login-btn").classList.remove("hidden");
                        document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = `
    <div class="success"> ${'[##cms.query.lid|(1)##]' == '1' ? `ثبت نام شما با موفقیت انجام شد، لطفا جهت تکمیل فرایند ثبت نام، اطلاعات زیر را وارد نمایید` :
                                '[##cms.query.lid|(1)##]' == '3' ? `تم تسجيلك بنجاح، يرجى إدخال المعلومات أدناه لإكمال عملية التسجيل` :
                                    `Your registration was successful`
                            }</div>`;
                        $bc.setSource("complete.registration", {
                            rkey: responseJson.rkey,
                            run: true
                        });
                    }

                } else {
                    document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = `
    <div class="error"> ${'[##cms.query.lid|(1)##]' == '1' ? `خطا در انجام عملیات` :
                            '[##cms.query.lid|(1)##]' == '3' ? `خطأ في العملية` :
                                `Error in operation`
                        }</div>`;

                };
                setTimeout(function () {
                    document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = "";
                }, 3000);
            }
        }
        function editUser(args) {
            const stringJson = JSON.stringify(args.source?.rows[0]);
            $bc.setSource("page.editUser", {
                value: stringJson,
                run: true
            });
        };

        async function onProcessedEditUser(args) {
            document.querySelector('.main-operationUser-container').querySelector('.action-loading').classList.add('hidden');
            const response = args.response;
            if (response.status == 200) {
                const responseJson = await response.json();
                if (!responseJson.errorMessage) {
                    if (responseJson.errorid == 102) {
                        document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = `
    <div class="success"> ${'[##cms.query.lid|(1)##]' == '1' ? `اطلاعات شما با موفقیت ثبت شد` :
                                '[##cms.query.lid|(1)##]' == '3' ? `تم تسجيل معلوماتك بنجاح` :
                                    `Your information has been successfully registered`
                            }</div>`;
                    } else {
                        document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = `
    <div class="error"> ${'[##cms.query.lid|(1)##]' == '1' ? `خطا در انجام عملیات` :
                                '[##cms.query.lid|(1)##]' == '3' ? `خطأ في العملية` :
                                    `Error in operation`
                            }</div>`;

                    };
                } else {
                    document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = `
    <div class="error"> ${'[##cms.query.lid|(1)##]' == '1' ? `خطا در انجام عملیات` :
                            '[##cms.query.lid|(1)##]' == '3' ? `خطأ في العملية` :
                                `Error in operation`
                        }</div>`;

                };
                setTimeout(function () {
                    document.querySelector(".main-operationUser-container").querySelector(".api-message").innerHTML = "";
                }, 3000);
            }
        };

    </script>

</body>

</html>